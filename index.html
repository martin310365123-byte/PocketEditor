<!doctype html>
<p class="muted">下載前，請閱讀並同意 <a href="eula.html" target="_blank" rel="noopener">最終用戶授權合約（EULA）</a> 與
<a href="privacy.html" target="_blank" rel="noopener">隱私權政策</a>。您也可保留一份副本。</p>
<label style="display:flex;gap:8px;align-items:flex-start;margin-top:10px">
<input type="checkbox" id="consent-check" style="margin-top:4px">
<span>我已閱讀並同意上述條款，且年滿法定年齡。</span>
</label>
<div class="actions">
<button class="btn secondary" id="consent-cancel">不同意</button>
<button class="btn" id="consent-agree" disabled>同意並下載</button>
</div>
<p class="muted" style="margin-top:6px">此同意不會被記錄，您每次下載都會再次看到本提示。</p>
</div>
</div>


<noscript>
<div style="margin:12px 0;padding:12px;border:1px solid #b00;color:#b00;background:#fff3f3;border-radius:8px">
您的瀏覽器已停用 JavaScript，因此無法顯示安裝同意書與下載按鈕。
請先啟用 JavaScript，或直接前往
<a href="https://github.com/martin310365123-byte/PocketEditor/releases/latest" rel="noopener">GitHub Releases</a>
下載（請先閱讀並遵循 EULA/隱私權政策）。
</div>
</noscript>


<script>
// 年份
document.getElementById('y').textContent = new Date().getFullYear();


// === Button-only 同意書邏輯（每次詢問；Edge 相容） ===
(function(){
const modal = document.getElementById('consent-modal');
const agreeBtn = document.getElementById('consent-agree');
const cancelBtn = document.getElementById('consent-cancel');
const closeX = document.getElementById('consent-close');
const checkbox = document.getElementById('consent-check');


let pendingUrl = null;


function openModal(url){
pendingUrl = url; checkbox.checked = false; agreeBtn.disabled = true;
modal.style.display = 'flex'; modal.classList.add('show'); modal.setAttribute('aria-hidden','false');
}
function closeModal(){ modal.classList.remove('show'); modal.setAttribute('aria-hidden','true'); modal.style.display = 'none'; pendingUrl = null; }


checkbox.addEventListener('change', ()=>{ agreeBtn.disabled = !checkbox.checked; });
cancelBtn.addEventListener('click', closeModal);
closeX.addEventListener('click', closeModal);
modal.addEventListener('click', (e)=>{ if(e.target===modal) closeModal(); });
document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeModal(); });


function bindButton(btn){
if(!btn || btn.dataset.consentBound==='1') return;
const url = btn.getAttribute('data-href');
if(!url) return;
btn.addEventListener('click', (e)=>{ e.preventDefault(); openModal(url); }, true);
btn.addEventListener('pointerdown', (e)=>{ e.preventDefault(); }, true);
btn.dataset.consentBound = '1';
}


// 綁定所有需要同意的按鈕
document.querySelectorAll('button[data-need-consent]').forEach(bindButton);


agreeBtn.addEventListener('click', ()=>{
if(checkbox.checked && pendingUrl){
const url = pendingUrl; closeModal(); window.location.assign(url);
}
});
})();
</script>
</body>
</html>
